<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <!-- ç¦ç”¨åŒå‡»ç¼©æ”¾ï¼Œä¿è¯åº”ç”¨è´¨æ„Ÿ -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Markdown A4 æ‰“å° (æ‰‹æœºä¿®å¤ç‰ˆ)</title>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <style>
        /* ---------- åŸºç¡€è®¾ç½® ---------- */
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body {
            margin: 0; padding: 0;
            font-family: -apple-system, BlinkMacSystemFont, sans-serif;
            background-color: #f0f2f5;
            height: 100vh;
            overflow: hidden; /* ç¦æ­¢ Body æ»šåŠ¨ï¼Œç”±å†…éƒ¨å®¹å™¨æ¥ç®¡ */
        }

        /* å¸ƒå±€å®¹å™¨ */
        .container {
            width: 100%;
            height: 100%;
            display: flex;
        }

        /* ---------- å·¦ä¾§ï¼šç¼–è¾‘å™¨ ---------- */
        .editor-pane {
            width: 50%; /* ç”µè„‘é»˜è®¤åˆ†å± */
            height: 100%;
            display: flex;
            flex-direction: column;
            background: #2d2d2d;
            border-right: 1px solid #444;
        }

        .toolbar {
            height: 50px;
            background: #1e1e1e;
            color: #fff;
            display: flex;
            align-items: center;
            padding: 0 15px;
            justify-content: space-between;
            flex-shrink: 0;
        }
        .toolbar h1 { margin: 0; font-size: 16px; font-weight: normal; }

        textarea {
            flex: 1;
            width: 100%;
            background: #2d2d2d;
            color: #e0e0e0;
            border: none;
            padding: 15px;
            resize: none;
            font-size: 16px;
            line-height: 1.6;
            outline: none;
        }

        /* ---------- å³ä¾§ï¼šé¢„è§ˆåŒº ---------- */
        .preview-pane {
            width: 50%; /* ç”µè„‘é»˜è®¤åˆ†å± */
            height: 100%;
            background: #525659;
            overflow-y: auto; /* å…è®¸å‚ç›´æ»šåŠ¨ */
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 30px 0;
            position: relative;
        }

        /* A4 çº¸å¼ æ ·å¼ */
        .a4-page {
            width: 210mm;
            min-height: 297mm; /* ä»…åœ¨å±å¹•é¢„è§ˆæ—¶ç”Ÿæ•ˆ */
            background: white;
            padding: 20mm; /* å±å¹•é¢„è§ˆæ—¶çš„å†…è¾¹è· */
            box-shadow: 0 4px 8px rgba(0,0,0,0.3);
            flex-shrink: 0;
            color: #000;
        }

        /* æŒ‰é’®æ ·å¼ */
        .btn {
            background: #007bff; color: white; border: none;
            padding: 6px 12px; border-radius: 4px; font-size: 14px;
        }

        /* æ‚¬æµ®åˆ‡æ¢æŒ‰é’® (æ‰‹æœºä¸“ç”¨) */
        .fab-btn {
            display: none; /* ç”µè„‘ç«¯éšè— */
            position: fixed; bottom: 30px; right: 20px;
            width: 60px; height: 60px; border-radius: 50%;
            background: #007bff; color: white;
            border: none; box-shadow: 0 4px 12px rgba(0,0,0,0.4);
            font-size: 24px; z-index: 999;
            justify-content: center; align-items: center;
        }

        /* ---------- æ‰‹æœºç«¯é€‚é…é€»è¾‘ (æ ¸å¿ƒä¿®å¤) ---------- */
        @media screen and (max-width: 768px) {
            /* 1. å¼ºåˆ¶å˜ä¸ºå•æ å¸ƒå±€ */
            .editor-pane, .preview-pane {
                width: 100%;
                height: 100%;
                border: none;
            }

            /* 2. é»˜è®¤çŠ¶æ€ï¼šåªæ˜¾ç¤ºç¼–è¾‘å™¨ï¼Œéšè—é¢„è§ˆ */
            .editor-pane { display: flex; }
            .preview-pane { display: none; }

            /* 3. é¢„è§ˆçŠ¶æ€ (é€šè¿‡ JS æ·»åŠ  class å®ç°) */
            body.mode-preview .editor-pane { display: none; }
            body.mode-preview .preview-pane { display: flex; }

            /* 4. æ˜¾ç¤ºæ‚¬æµ®æŒ‰é’® */
            .fab-btn { display: flex; }

            /* 5. è°ƒæ•´ A4 åœ¨æ‰‹æœºä¸Šçš„æ˜¾ç¤ºï¼Œå…è®¸æ¨ªå‘æ»šåŠ¨æŸ¥çœ‹å…¨è²Œ */
            .preview-pane {
                display: none; /* é»˜è®¤éšè— */
                align-items: flex-start; /* é å·¦å¯¹é½ï¼Œæ–¹ä¾¿æ¨ªå‘æ»šåŠ¨ */
                overflow-x: auto; /* å…è®¸æ¨ªå‘æ»šåŠ¨ */
                padding: 10px;
            }
            
            /* æ‰‹æœºä¸Šé¢„è§ˆæ—¶çš„é¡¶éƒ¨å·¥å…·æ  */
            .mobile-preview-header {
                width: 100%;
                background: #333;
                color: white;
                padding: 10px;
                text-align: center;
                display: none; /* JSæ§åˆ¶æ˜¾ç¤º */
                margin-bottom: 10px;
            }
        }

        /* ---------- Markdown å†…å®¹æ¸²æŸ“æ ·å¼ ---------- */
        .markdown-body { font-size: 11pt; line-height: 1.6; }
        .markdown-body h1 { border-bottom: 1px solid #ddd; padding-bottom: 0.3em; }
        .markdown-body img { max-width: 100%; }
        .markdown-body pre { background: #f5f5f5; padding: 10px; overflow-x: auto; }
        .markdown-body table { border-collapse: collapse; width: 100%; margin-bottom: 1em; }
        .markdown-body th, .markdown-body td { border: 1px solid #ddd; padding: 8px; }

        /* ---------- æ‰“å°æ ·å¼ (ä¿®å¤å¤šé¡µç™½çº¸é—®é¢˜) ---------- */
        @media print {
            .editor-pane, .fab-btn, .mobile-preview-header { display: none !important; }
            
            /* ç¡®ä¿é¢„è§ˆåŒºæ˜¾ç¤º */
            body.mode-preview .preview-pane { display: block; } 
            .preview-pane { display: block !important; overflow: visible !important; height: auto !important; padding: 0 !important; background: white; }
            .container { display: block; height: auto; }
            
            html, body { height: auto; overflow: visible; background: white; }

            .a4-page {
                width: 100% !important;
                min-height: 0 !important; /* å–æ¶ˆæœ€å°é«˜åº¦ */
                height: auto !important;
                margin: 0 !important;
                padding: 0 !important; /* è®© @page æ§åˆ¶è¾¹è· */
                box-shadow: none;
            }

            @page {
                size: A4;
                margin: 20mm; /* æ‰“å°æœºè¾¹è· */
            }
            
            /* é˜²æ­¢æœ€åä¸€è¡ŒæŒ¤å‡ºæ–°é¡µ */
            .markdown-body > *:last-child { margin-bottom: 0; }
        }
    </style>
</head>
<body>

<div class="container">
    <!-- ç¼–è¾‘å™¨ -->
    <div class="editor-pane">
        <div class="toolbar">
            <h1>Markdown ç¼–è¾‘</h1>
            <!-- ç”µè„‘ç«¯æ‰“å°æŒ‰é’® -->
            <button class="btn" onclick="window.print()" style="display: none;" id="pc-print-btn">æ‰“å°</button>
        </div>
        <textarea id="input" placeholder="è¯·è¾“å…¥å†…å®¹..."></textarea>
    </div>

    <!-- é¢„è§ˆå™¨ -->
    <div class="preview-pane">
        <!-- æ‰‹æœºç«¯é¢„è§ˆæ—¶çš„é¡¶éƒ¨æç¤º -->
        <div class="mobile-preview-header" id="mobile-header">
            <button class="btn" onclick="window.print()">ğŸ–¨ï¸ ç‚¹å‡»è¿™é‡Œæ‰“å° / å­˜ä¸º PDF</button>
            <div style="font-size: 12px; margin-top:5px; color:#ccc;">(å·¦å³æ»‘åŠ¨å¯æŸ¥çœ‹å®Œæ•´çº¸å¼ )</div>
        </div>
        <div id="output" class="a4-page markdown-body"></div>
    </div>
</div>

<!-- æ‰‹æœºç«¯åˆ‡æ¢æŒ‰é’® -->
<button class="fab-btn" id="fab" onclick="toggleMode()">ğŸ‘ï¸</button>

<script>
    const input = document.getElementById('input');
    const output = document.getElementById('output');
    const fab = document.getElementById('fab');
    const body = document.body;
    const mobileHeader = document.getElementById('mobile-header');
    const pcPrintBtn = document.getElementById('pc-print-btn');

    // é»˜è®¤å†…å®¹
    const defaultText = `# æ‰‹æœºç«¯å®Œç¾ä¿®å¤ç‰ˆ

1. **é»˜è®¤æ˜¯ç¼–è¾‘æ¨¡å¼**ï¼šæ‰“å¼€å°±æ˜¯è¾“å…¥æ¡†ã€‚
2. **åˆ‡æ¢é¢„è§ˆ**ï¼šç‚¹å‡»å³ä¸‹è§’è“è‰²çœ¼ç›æŒ‰é’®ã€‚
3. **æ‰“å°**ï¼šé¢„è§ˆç•Œé¢é¡¶éƒ¨æœ‰æ‰“å°æŒ‰é’®ã€‚

---

## è¡¨æ ¼æµ‹è¯•
| é¡¹ç›® | çŠ¶æ€ |
| :--- | :--- |
| æ‰‹æœºé¢„è§ˆ | âœ… ä¿®å¤ |
| å¤šé¡µç™½çº¸ | âœ… ä¿®å¤ |
| æ‰“å°åŠŸèƒ½ | âœ… æ­£å¸¸ |
`;

    input.value = defaultText;

    // æ¸²æŸ“å‡½æ•°
    function render() {
        const text = input.value.trim();
        output.innerHTML = marked.parse(text);
    }
    
    // ç›‘å¬è¾“å…¥
    input.addEventListener('input', render);
    render();

    // åˆ‡æ¢æ¨¡å¼ (æ ¸å¿ƒä¿®å¤é€»è¾‘)
    function toggleMode() {
        // åˆ‡æ¢ body çš„ class
        body.classList.toggle('mode-preview');

        // æ£€æŸ¥å½“å‰æ˜¯ä¸æ˜¯é¢„è§ˆæ¨¡å¼
        const isPreview = body.classList.contains('mode-preview');

        if (isPreview) {
            // ç°åœ¨æ˜¯é¢„è§ˆæ¨¡å¼
            fab.innerHTML = 'âœï¸'; // æŒ‰é’®å˜ç¬”
            mobileHeader.style.display = 'block'; // æ˜¾ç¤ºæ‰‹æœºæ‰“å°æ¡
        } else {
            // ç°åœ¨æ˜¯ç¼–è¾‘æ¨¡å¼
            fab.innerHTML = 'ğŸ‘ï¸'; // æŒ‰é’®å˜çœ¼
            mobileHeader.style.display = 'none'; // éšè—æ‰‹æœºæ‰“å°æ¡
        }
    }

    // ç®€å•çš„å“åº”å¼å¤„ç†ï¼šç”µè„‘ä¸Šæ˜¾ç¤ºæ‰“å°æŒ‰é’®ï¼Œæ‰‹æœºä¸Šéšè—
    if(window.innerWidth > 768) {
        pcPrintBtn.style.display = 'block';
    }
</script>

</body>
</html>